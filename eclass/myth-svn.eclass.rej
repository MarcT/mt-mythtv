***************
*** 23,29 ****
  
  EXPORT_FUNCTIONS src_unpack src_compile src_install
  
- MYTHPLUGINS="mytharchive mythbrowser mythflix mythgallery mythgame mythmovies mythmusic mythnews mythvideo mythweather mythweb mythzoneminder"
  
  _MODULE=${PN}
  
--- 23,29 ----
  
  EXPORT_FUNCTIONS src_unpack src_compile src_install
  
+ MYTHPLUGINS="mytharchive mythbrowser mythgallery mythgame mythmovies mythmusic mythnews mythvideo mythweather mythweb mythzoneminder"
  
  _MODULE=${PN}
  
***************
*** 51,77 ****
  myth-svn_src_unpack() {
  	#
  	# Deal with subversion eclass avoiding updates when
- 	# the last run was within an hour
  	#
- 	if hasq ${_MODULE} ${MYTHPLUGINS} ; then
- 
- 		[ -z "${MYTHPLUGINS_SVN_REVISION}" ] || ESVN_FETCH_CMD="svn checkout --revision ${MYTHTV_SVN_REVISION}"
- 		[ -z "${MYTHPLUGINS_SVN_REVISION}" ] || ESVN_UPDATE_CMD="svn update --revision ${MYTHTV_SVN_REVISION}"
  
- 		ENTRIES=/usr/portage/distfiles/svn-src/mythplugins/mythplugins/.svn/entries
- 		if [ -f "${ENTRIES}" ] ; then
- 			local REV=$(grep '  revision="' ${ENTRIES} | sed -e 'sX^[^"]*XX' -e 'sX".*XX' )
- 			if [ -n "${MYTHPLUGINS_SVN_REVISION}" ] && [ "${REV}" != "${MYTHPLUGINS_SVN_REVISION}" ] ; then
- 				touch -t 199901010101 ${ENTRIES}
- 			fi
- 			local NOW=$(date +%s) UPDATE=$(date -r ${ENTRIES} +%s) INTERVAL=3600
- 			if (( ${NOW} - ${UPDATE} <= ${INTERVAL} )); then
- 				echo
- 				ewarn "You ran this within 1 hour of another myth plugin ebuild,"
- 		        	ewarn "so it will skip the update.  To bypass this:"
- 				ewarn " touch -t 199901010101 ${ENTRIES}"
- 				echo
- 			fi
  		fi
  	fi
  
--- 51,74 ----
  myth-svn_src_unpack() {
  	#
  	# Deal with subversion eclass avoiding updates when
+ 	# the last run was within two hours
  	#
  
+ 	ENTRIES=${ESVN_STORE_DIR}/${ESVN_PROJECT}/${ESVN_PROJECT}/.svn/entries
+ 	if [ -f "${ENTRIES}" ] ; then
+ 		local REV=`svn info ${ESVN_STORE_DIR}/${ESVN_PROJECT}/${ESVN_PROJECT} | grep 'Revision: ' | sed 's/[^0-9]*\([0-9]*\).*/\1/' `
+ 		#local REV=$(grep '  revision="' ${ENTRIES} | sed -e 'sX^[^"]*XX' -e 'sX".*XX' )
+ 		if [ -n "${MYTHTV_SVN_REVISION}" ] && [ "${REV}" != "${MYTHTV_SVN_REVISION}" ] ; then
+ 			touch -t 199901010101 ${ENTRIES}
+ 		fi
+ 		local NOW=$(date +%s) UPDATE=$(date -r ${ENTRIES} +%s) INTERVAL=7200
+ 		if (( ${NOW} - ${UPDATE} <= ${INTERVAL} )); then
+ 			echo
+ 			ewarn "You checked out revision ${REV} within the last 2 hours,"
+ 	        	ewarn "so the svn update will be skipped.  To bypass this:"
+ 			ewarn "  touch -t 199901010101 ${ENTRIES}"
+ 			echo
+ 			ESVN_UPDATE_CMD="true"
  		fi
  	fi
  
